.版本 2

.程序集 Ex_XML, , 公开
.子程序 取指针, 整数型, 公开
    

.子程序 释放, , 公开, 释放当前XML树，释放后该XML树将不再可用。如果XML树在离开作用域前没有释放，系统会自动释放XML树。
    

.子程序 创建, 逻辑型, 公开, 在内存中创建一个新的XML的解析树。如果XML树已经创建，则自动释放当前XML树，然后执行创建操作。成功返回真，失败返回假。
    .参数 根节点名, 文本型, , 本参数提供所要新建解析树根节点的名称。

    

.子程序 取XML对象, 对象, 公开
    

.子程序 导入文件, 逻辑型, 公开, 从XML文件读入数据，再进行操作。成功返回真，失败返回假
    .参数 XML文件路径, 文本型, 可空, 指定欲导入的XML文件路径

    

.子程序 导入XML数据, 逻辑型, 公开, 把XML源码直接导入，再进行操作。成功返回真，失败返回假
    .参数 XML源码, 字节集, , 要导入的XML源码。如<Test></Test>

    

.子程序 导出到文件, 逻辑型, 公开
    .参数 XML文件路径, 文本型, 可空, 指定欲保存的XML文件路径，如果是用 导入文件( ) 命令导入的，可以留空。

    

.子程序 取XML文本, 文本型, 公开, 取出XML中的所有文本，不含XML标记。
    

.子程序 取XML数据, 字节集, 公开, 取当前XML树的全部数据。如果执行失败，返回值为空。本方法所返回的数据与“导出到文件()”所写入文件的数据完全等同。
    

.子程序 修改属性值, 逻辑型, 公开, 修改指定节点的属性值。成功返回真，失败返回假。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。
    .参数 属性名, 文本型, , 本参数提供“修改属性值”命令欲修改节点的属性名。
    .参数 新属性值, 文本型, , 本参数提供“修改属性值”命令欲修改节点的新属性值。

    

.子程序 修改节点值, 逻辑型, 公开, 修改指定节点的值。成功返回真，失败返回假。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。
    .参数 新节点值, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。

    

.子程序 修改节点名, 逻辑型, 公开, 修改指定节点的名称。成功返回真，失败返回假。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。
    .参数 新节点名, 文本型, , 本参数提供“修改节点名”命令欲修改节点的新名称。

    

.子程序 插入节点, 逻辑型, 公开, 新建一个节点，并把该参数节点作为该新节点的父节点，然后插入到XML树中。成功返回真，失败返回假。
    .参数 父节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。
    .参数 新节点名, 文本型, , 本参数提供“插入节点”命令所需要的新插入节点的名称。注意：名称不能以数字开头。
    .参数 新节点值, 文本型, 可空, 本参数作为“插入节点”命令所需要的新插入节点的值。
    .参数 使用CDATA, 逻辑型, 可空, 可以被省略。如果本参数为真，则节点值文本将被“<![CDATA[”和“]]>”包围，这意味着该文本可以包含任意字符（以不影响CDATA解析为限）。如果被省略，默认为假。

    

.子程序 删除节点, 逻辑型, 公开, 删除给定节点和他的所有子节点，该方法不允许删除根节点。行成功返回真，行失败返回假。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。

    

.子程序 插入属性, , 公开, 在参数节点中插入一个新的属性，并给属性赋值。成功返回真，失败返回假。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。
    .参数 新属性名, 文本型, , 本参数提供“插入属性”命令欲插入的节点新属性的名称。
    .参数 属性值, 文本型, 可空, 本参数作为“插入属性”命令欲插入的节点新属性的值。

    

.子程序 删除属性, 逻辑型, 公开, 删除给定节点的指定属性。成功返回真，失败返回假。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。
    .参数 属性名, 文本型, , 本参数提供“删除属性”命令欲删除属性的名称。

    

.子程序 取XML文件路径, 文本型, 公开
    

.子程序 取属性值, 逻辑型, 公开, 成功返回属性值，失败返回空文本。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。
    .参数 属性名或索引, 文本型, , 本参数提供“取属性值”命令所需要的节点属性的名称。该参数也可以是属性的索引，例如“@1”表示节点的第一个属性。
    .参数 返回文本, 文本型, 参考 可空

    

.子程序 枚举属性名值, 整数型, 公开, 取得参数节点的所有属性的名称。成功返回子节点的数量，失败返回0。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。
    .参数 属性名称数组, 文本型, 可空 数组, 提供参数数据时只能提供变量数组。本参数作为“取全部属性名”命令的填充参数。“取全部属性名”命令执行完毕后，该参数内容为节点的所有属性名称组成的数组。
    .参数 属性值数组, 文本型, 可空 数组, 提供参数数据时只能提供变量数组。本参数作为“取全部属性值”命令的填充参数。“取全部属性名”命令执行完毕后，该参数内容为节点的所有属性值组成的数组。

    

.子程序 取属性个数, 整数型, 公开, 得由参数节点的属性个数。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。

    

.子程序 取节点值, 文本型, 公开
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。

    

.子程序 枚举子节点名, 整数型, 公开, 取得参数节点的所有子节点名称。成功返回子节点的数量，失败返回0。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。
    .参数 子节点名称数组, 文本型, 数组, 提供参数数据时只能提供变量数组。本参数作为“取子节点名”命令的填充参数。“取子节点名”命令执行完毕后，该参数内容为所有子节点名称组成的数组.

    

.子程序 取子节点个数, 整数型, 公开, 取得指定节点的所有子节点的个数。成功返回节点个数，失败返回0。
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。
    .参数 子节点个数, 整数型, 参考 可空

    

.子程序 取根节点名, 文本型, 公开, 成功返回根节点名称，失败返回空文本。
    

.子程序 取父节点名, 文本型, 公开
    .参数 子节点对象, 对象

    

.子程序 取父节点对象, 对象, 公开
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。

    

.子程序 取子节点对象, 对象, 公开
    .参数 节点全路径, 文本型, , 本参数为节点在解析树中的全路径，通过“/”字符把节点名称串联起来，同时可以使用@+索引(从1开始)的方式，例如“根节点/子节点/叶子节点”。

    

